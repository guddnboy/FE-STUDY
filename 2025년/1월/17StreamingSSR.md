# Streaming SSR이란 무엇인가요?

`Streaming SSR`은 서버에서 html을 준비된 순서대로 **점진적으로 streaming하여 클라이언트 측에 전달**하는 기술입니다.

기존 SSR 방식은 서버에서 모든 데이터를 처리한 뒤, 완전한 html을 전달하지만 `Streaming SSR` 방식은 서버가 데이터를 준비하는 즉시 **html 조각을 스트림 형식으로 전달**하고 클라이언트는 이를 실시간으로 렌더링합니다.

## Streaming SSR의 장점은 무엇인가요?

사용자가 **중요한 컨텐츠를 먼저 확인**할 수 있어, 사용자 경험이 향상 됩니다.

## 주의해야 할 점은 무엇인가요?

클라이언트에서 부분적으로 렌더링 되는 html이 정상적으로 hydration 될 수 있도록 설계가 필요합니다. 렌더링 되는 html과 리액트의 상태가 불일치할 경우에 리액트가 경고를 띄우거나 예기치 못한 UI 동작이 나타날 수 있습니다.

## 어떻게 방지할 수 있나요?

서버와 클라이언트에서 **동일한 데이터 소스를 사용**하도록 해야합니다. 예를 들어, `Tanstack Query`같은 라이브러리를 활용하면 데이터를 동기화하기 편해집니다. 또한 `Suspense`와 `fallback`을 활용하면 데이터 로드 중 안정적인 UI를 제공할 수 있습니다.

# 추가로 학습한 부분

## Tanstack Query란 무엇인가요?

서버에서 가져온 데이터를 상태관리 해주도록 하는 라이브러리가 react-query입니다. 하지만 해당 라이브러리가 vue,svelte 등 다른 프레임워크에서도 사용이 가능해지면서 Tanstack Query로 네이밍이 변경되었습니다. 즉, Tanstack Query는 서버의 데이터 상태관리를 하기 위한 라이브러리입니다.

### 데이터 캐싱

Tanstack Query는 데이터를 가져올 때 항상 쿼리 키를 지정하게 됩니다. 쿼리 키는 캐시된 데이터와 비교하여 새로운 요청을 할 것인지, 캐시된 데이터를 사용할 것인지 결정하는 기준이 됩니다. 쿼리 키와 일치하는 캐시된 데이터가 있을 경우 서버에 요청하지 않고, 캐시된 데이터를 사용하여 중복된 요청을 줄일 수 있습니다.

### 데이터의 신선도

Tanstack Query는 데이터를 신선한 상태(Fresh)나 상한 상태(Stale)로 구분하여 관리합니다. 캐시된 데이터가 신선하면 사용하고 그렇지 않다면 서버에 요청을 해서 신선한 상태로 업데이트합니다. 데이터가 상하는 시간은 `setStaleTime`으로 설정할 수 있고, 상했는지 여부는 `isStale`로 확인할 수 있습니다.
